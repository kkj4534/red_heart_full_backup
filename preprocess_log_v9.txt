INFO:RedHeart.DataPreprocessingV3:ë””ë°”ì´ìŠ¤: cuda
INFO:RedHeart.DataPreprocessingV3:Loading sentence transformer: sentence-transformers/all-MiniLM-L6-v2
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
INFO:RedHeart.DataPreprocessingV3:ğŸŒ ë²ˆì—­ íŒŒì´í”„ë¼ì¸ ì´ˆê¸°í™” ì¤‘...
INFO:RedHeart.DataPreprocessingV3:ğŸ“¥ NLLB-200 ëª¨ë¸ ë¡œë“œ ì¤‘: facebook/nllb-200-distilled-600M
INFO:RedHeart.DataPreprocessingV3:âœ… NLLB ëª¨ë¸ GPU ë¡œë“œ ì™„ë£Œ
INFO:RedHeart.DataPreprocessingV3:âœ… HelpingAI ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ v3 ì´ˆê¸°í™” ì™„ë£Œ
INFO:RedHeart.DataPreprocessingV3:ğŸ“š ë°ì´í„°ì…‹ ì²˜ë¦¬ ì‹œì‘: parsed_raw_datasets.json
INFO:RedHeart.DataPreprocessingV3:ì´ 3ê°œ ìƒ˜í”Œ ì²˜ë¦¬ ì˜ˆì •
INFO:RedHeart.DataPreprocessingV3:ğŸ”„ HelpingAI ì—”ì§„ ì´ˆê¸°í™” ì¤‘...
INFO:RedHeart.AdvancedLLM:ëª¨ë¸ ì„¤ì • ì¤€ë¹„ ì™„ë£Œ: ['helpingai']
INFO:RedHeart.AdvancedLLM:ë™ì  GPU-RAM ìŠ¤ì™‘ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ
INFO:RedHeart.DataPreprocessingV3:âœ… LLM ì´ˆê¸°í™” ì™„ë£Œ
INFO:RedHeart.DataPreprocessingV3:ì§„í–‰ë¥ : 0/3 (0.0%)
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00,  1.52it/s]Batches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00,  1.52it/s]
ERROR:RedHeart.DataPreprocessingV3:NLLB ë²ˆì—­ ì‹¤íŒ¨: NllbTokenizerFast has no attribute lang_code_to_id
ERROR:RedHeart.DataPreprocessingV3:ìƒ˜í”Œ 0 ì²˜ë¦¬ ì‹¤íŒ¨: NLLB ë²ˆì—­ ì‹¤íŒ¨: NllbTokenizerFast has no attribute lang_code_to_id
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 80.07it/s]
ERROR:RedHeart.DataPreprocessingV3:NLLB ë²ˆì—­ ì‹¤íŒ¨: NllbTokenizerFast has no attribute lang_code_to_id
ERROR:RedHeart.DataPreprocessingV3:ìƒ˜í”Œ 1 ì²˜ë¦¬ ì‹¤íŒ¨: NLLB ë²ˆì—­ ì‹¤íŒ¨: NllbTokenizerFast has no attribute lang_code_to_id
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 84.80it/s]
ERROR:RedHeart.DataPreprocessingV3:NLLB ë²ˆì—­ ì‹¤íŒ¨: NllbTokenizerFast has no attribute lang_code_to_id
ERROR:RedHeart.DataPreprocessingV3:ìƒ˜í”Œ 2 ì²˜ë¦¬ ì‹¤íŒ¨: NLLB ë²ˆì—­ ì‹¤íŒ¨: NllbTokenizerFast has no attribute lang_code_to_id
ERROR:RedHeart.DataPreprocessingV3:ì—°ì† 3ê°œ ì‹¤íŒ¨ë¡œ ì¤‘ë‹¨
Traceback (most recent call last):
  File "/mnt/c/large_project/linux_red_heart/data_preprocessing_pipeline_v3.py", line 116, in translate_to_english
    forced_bos_token_id=self.nllb_tokenizer.lang_code_to_id['eng_Latn'],
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/large_project/linux_red_heart/red_heart_env/lib/python3.12/site-packages/transformers/tokenization_utils_base.py", line 1100, in __getattr__
    raise AttributeError(f"{self.__class__.__name__} has no attribute {key}")
AttributeError: NllbTokenizerFast has no attribute lang_code_to_id

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/large_project/linux_red_heart/data_preprocessing_pipeline_v3.py", line 503, in process_dataset
    result = self.process_single_item(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/large_project/linux_red_heart/data_preprocessing_pipeline_v3.py", line 449, in process_single_item
    emotion_result = self.analyze_emotions_with_llm(text)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/large_project/linux_red_heart/data_preprocessing_pipeline_v3.py", line 148, in analyze_emotions_with_llm
    english_text = self.translate_to_english(text)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/large_project/linux_red_heart/data_preprocessing_pipeline_v3.py", line 135, in translate_to_english
    raise RuntimeError(f"NLLB ë²ˆì—­ ì‹¤íŒ¨: {e}")
RuntimeError: NLLB ë²ˆì—­ ì‹¤íŒ¨: NllbTokenizerFast has no attribute lang_code_to_id

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/large_project/linux_red_heart/data_preprocessing_pipeline_v3.py", line 602, in <module>
    main()
  File "/mnt/c/large_project/linux_red_heart/data_preprocessing_pipeline_v3.py", line 595, in main
    preprocessor.process_dataset(
  File "/mnt/c/large_project/linux_red_heart/data_preprocessing_pipeline_v3.py", line 517, in process_dataset
    raise RuntimeError(f"ì „ì²˜ë¦¬ ì‹¤íŒ¨ - ì—°ì† {failed_count}ê°œ ìƒ˜í”Œ ì²˜ë¦¬ ì‹¤íŒ¨")
RuntimeError: ì „ì²˜ë¦¬ ì‹¤íŒ¨ - ì—°ì† 3ê°œ ìƒ˜í”Œ ì²˜ë¦¬ ì‹¤íŒ¨
