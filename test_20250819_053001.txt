🚀 Red Heart AI 통합 학습 시스템 시작
===========================================
[0;34m[INFO][0m 작업 디렉토리: /mnt/c/large_project/linux_red_heart
[0;34m[INFO][0m Red Heart AI 통합 환경 상태 확인 중...
[0;32m[SUCCESS][0m ✅ red_heart_env 가상환경 존재
[0;32m[SUCCESS][0m ✅ faiss-test conda 환경 존재
[0;32m[SUCCESS][0m ✅ FAISS 설치됨 및 작동 확인
✅ Red Heart AI 통합 환경 활성화 완료
   - venv: /mnt/c/large_project/linux_red_heart/red_heart_env
   - conda: faiss-test (함께 활성화됨)
   - python: /mnt/c/large_project/linux_red_heart/red_heart_env/bin/python
   - 환경 분리: faiss→conda subprocess, 나머지→venv
[0;32m[SUCCESS][0m ✅ 주요 패키지 (torch, transformers, numpy) 설치됨
[0;32m[SUCCESS][0m 🎉 모든 환경이 이미 준비되어 있습니다!
✅ Red Heart AI 통합 환경 활성화 완료
   - venv: /mnt/c/large_project/linux_red_heart/red_heart_env
   - conda: faiss-test (함께 활성화됨)
   - python: /mnt/c/large_project/linux_red_heart/red_heart_env/bin/python
   - 환경 분리: faiss→conda subprocess, 나머지→venv
[0;32m[SUCCESS][0m ✅ Red Heart AI 통합 환경 활성화 완료
[0;32m[SUCCESS][0m    - venv: /mnt/c/large_project/linux_red_heart/red_heart_env
[0;32m[SUCCESS][0m    - conda: faiss-test 환경 준비됨
[0;32m[SUCCESS][0m    - python: /mnt/c/large_project/linux_red_heart/red_heart_env/bin/python
[0;32m[SUCCESS][0m    - 환경 분리: faiss→conda subprocess, 나머지→venv
[0;34m[INFO][0m Red Heart AI 통합 학습 시스템 시작
[0;34m[INFO][0m 환경 분리: conda(faiss) + venv(transformers,torch)
[0;34m[INFO][0m Red Heart AI 통합 학습 시스템 실행 시작...
[0;34m[INFO][0m 실행 모드: unified-test
[0;34m[INFO][0m 🧪 730M 최종 통합 시스템 학습 테스트 모드...
[0;34m[INFO][0m    - 60 에폭 학습 테스트 (--samples로 제한 가능)
[0;34m[INFO][0m    - LR 스윕, Sweet Spot, Parameter Crossover 포함
[0;34m[INFO][0m    - Advanced Training Techniques 활성화
[0;34m[INFO][0m    ✨ 최종 통합 시스템 (730M) 사용
2025-08-19 05:31:14,157 - RedHeart.UnifiedTrainingFinal - INFO - ⚠️ 테스트 모드: 3 에폭 실행
2025-08-19 05:31:14,274 - RedHeart.Config - INFO - GPU 직접 사용: None (사용률: 0.0%, 필요: 500MB)
2025-08-19 05:31:14,274 - RedHeart.UnifiedTrainingFinal - INFO - ======================================================================
2025-08-19 05:31:14,274 - RedHeart.UnifiedTrainingFinal - INFO - Red Heart AI 최종 통합 학습 시스템 초기화
2025-08-19 05:31:14,274 - RedHeart.UnifiedTrainingFinal - INFO -   - 모델 크기: 730M 파라미터
2025-08-19 05:31:14,275 - RedHeart.UnifiedTrainingFinal - INFO -   - 총 에폭: 3
2025-08-19 05:31:14,275 - RedHeart.UnifiedTrainingFinal - INFO -   - 배치 사이즈: 2 (GA=32)
2025-08-19 05:31:14,275 - RedHeart.UnifiedTrainingFinal - INFO -   - 디바이스: cuda
2025-08-19 05:31:14,275 - RedHeart.UnifiedTrainingFinal - INFO - ======================================================================
2025-08-19 05:31:14,278 - training.enhanced_checkpoint_manager - INFO - ✅ Enhanced CheckpointManager 초기화
2025-08-19 05:31:14,279 - training.enhanced_checkpoint_manager - INFO -   - 저장 디렉토리: training/checkpoints_final
2025-08-19 05:31:14,279 - training.enhanced_checkpoint_manager - INFO -   - 최대 체크포인트: 30개
2025-08-19 05:31:14,279 - training.enhanced_checkpoint_manager - INFO -   - 저장 간격: 2 에폭마다
2025-08-19 05:31:14,279 - training.lr_sweep_optimizer - INFO - ✅ LR Sweep Optimizer 초기화
2025-08-19 05:31:14,279 - training.lr_sweep_optimizer - INFO -   - 스윕 범위: 1.0e-05 ~ 1.0e-02
2025-08-19 05:31:14,280 - training.lr_sweep_optimizer - INFO -   - 테스트 LR 값: ['1.0e-05', '5.6e-05', '3.2e-04', '1.8e-03', '1.0e-02']
2025-08-19 05:31:14,280 - training.lr_sweep_optimizer - INFO -   - 각 LR당 3 에폭 테스트
2025-08-19 05:31:14,280 - training.sweet_spot_detector - INFO - ✅ Sweet Spot Detector 초기화
2025-08-19 05:31:14,280 - training.sweet_spot_detector - INFO -   - 윈도우 크기: 5
2025-08-19 05:31:14,280 - training.sweet_spot_detector - INFO -   - 안정성 임계값: 0.01
2025-08-19 05:31:14,281 - training.sweet_spot_detector - INFO -   - Patience: 10
2025-08-19 05:31:14,281 - training.parameter_crossover_system - INFO - ✅ Parameter Crossover System 초기화
2025-08-19 05:31:14,281 - training.parameter_crossover_system - INFO -   - 전략: selective
2025-08-19 05:31:14,281 - training.parameter_crossover_system - INFO -   - 블렌드 비율: 0.7
2025-08-19 05:31:14,281 - training.oom_handler - INFO - ✅ OOM Handler 초기화
2025-08-19 05:31:14,281 - training.oom_handler - INFO -   - 초기 배치 사이즈: 2
2025-08-19 05:31:14,282 - training.oom_handler - INFO -   - 최소 배치 사이즈: 1
2025-08-19 05:31:14,282 - training.oom_handler - INFO -   - Gradient Accumulation: 32
2025-08-19 05:31:14,282 - training.oom_handler - INFO -   - 메모리 임계값: 85.0%
2025-08-19 05:31:14,282 - training.oom_handler - INFO -   - 디바이스: cuda
2025-08-19 05:31:14,282 - training.advanced_training_techniques - INFO - ✅ Advanced Training Manager 초기화
2025-08-19 05:31:14,283 - training.advanced_training_techniques - INFO -   - label_smoothing: 활성화
2025-08-19 05:31:14,283 - training.advanced_training_techniques - INFO -   - rdrop: 활성화
2025-08-19 05:31:14,283 - training.advanced_training_techniques - INFO -   - ema: 활성화
2025-08-19 05:31:14,283 - training.advanced_training_techniques - INFO -   - llrd: 활성화
2025-08-19 05:31:14,283 - RedHeart.UnifiedTrainingFinal - INFO - ✅ 모든 컴포넌트 초기화 완료
/mnt/c/large_project/linux_red_heart/red_heart_env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
2025-08-19 05:31:14,791 - unified_backbone - INFO - 백본 총 파라미터: 90,624,132 (90.62M)
2025-08-19 05:31:14,792 - unified_backbone - INFO - 학습 가능 파라미터: 90,624,132 (90.62M)
2025-08-19 05:31:14,920 - unified_heads - INFO - 감정 헤드 파라미터: 17,254,583 (17.25M)
2025-08-19 05:31:15,037 - unified_heads - INFO - 벤담 헤드 파라미터: 13,871,919 (13.87M)
2025-08-19 05:31:15,199 - unified_heads - INFO - 후회 헤드 파라미터: 19,897,161 (19.90M)
2025-08-19 05:31:15,378 - unified_heads - INFO - SURD 헤드 파라미터: 12,025,739 (12.03M)
2025-08-19 05:31:16,320 - analyzer_neural_modules - INFO - NeuralEmotionAnalyzer 초기화: 122,595,407 파라미터
2025-08-19 05:31:16,924 - analyzer_neural_modules - INFO - NeuralBenthamCalculator 초기화: 78,281,602 파라미터
2025-08-19 05:31:18,107 - analyzer_neural_modules - INFO - NeuralRegretAnalyzer 초기화: 153,872,666 파라미터
2025-08-19 05:31:18,216 - analyzer_neural_modules - INFO - NeuralSURDAnalyzer 초기화: 13,473,032 파라미터
2025-08-19 05:31:18,217 - analyzer_neural_modules - INFO - 전체 신경망 분석기 파라미터: 368,222,707 (368.2M)
2025-08-19 05:32:51,091 - RedHeart.Config - INFO - GPU 직접 사용: None (사용률: 0.0%, 필요: 500MB)
2025-08-19 05:32:51,095 - RedHeart.Config - INFO - 🔍 get_system_module 호출: module_id=translator
2025-08-19 05:32:51,095 - RedHeart.Config - INFO - 🔍 현재 등록된 모듈들: []
2025-08-19 05:32:51,095 - RedHeart.Config - INFO - 🔍 결과: None
2025-08-19 05:32:51,095 - RedHeartLinux.AdvancedEmotion - ERROR - 전역 translator 모듈을 찾을 수 없음 - 모듈 초기화 순서 확인 필요
2025-08-19 05:32:51,095 - advanced_analyzer_wrappers - ERROR - Advanced Emotion Wrapper 생성 실패: 전역 translator 모듈을 찾을 수 없음 - 모듈 초기화 순서 확인 필요
2025-08-19 05:32:51,513 - dynamic_gpu_manager - INFO - Dynamic GPU Manager initialized - Total GPU Memory: 8.0GB
2025-08-19 05:32:51,517 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-08-19 05:32:51,754 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /klue/bert-base/resolve/main/tokenizer_config.json HTTP/1.1" 307 0
2025-08-19 05:32:51,761 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/klue/bert-base/77c8b3d707df785034b4e50f2da5d37be5f0f546/tokenizer_config.json HTTP/1.1" 200 0
2025-08-19 05:32:52,007 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/klue/bert-base/tree/main/additional_chat_templates?recursive=False&expand=False HTTP/1.1" 404 64
2025-08-19 05:32:52,736 - advanced_regret_analyzer - INFO - ✅ 후회 분석기 강화 모듈 통합: 42.9M 파라미터 추가
2025-08-19 05:32:52,756 - advanced_regret_analyzer - INFO - 후회 분석용 MoE 시스템 초기화 완료 (3개 전문가)
2025-08-19 05:32:52,756 - dynamic_gpu_manager - INFO - Dynamic GPU Manager initialized - Total GPU Memory: 8.0GB
2025-08-19 05:32:52,757 - RedHeart.ThreeViewScenarioSystem - INFO - 3뷰 시나리오 시스템 GPU 메모리 관리 활성화
2025-08-19 05:32:52,757 - RedHeart.ThreeViewScenarioSystem - INFO - 3뷰 시나리오 시스템 초기화 완료 (온디맨드 로딩 방식)
2025-08-19 05:32:52,757 - advanced_regret_analyzer - INFO - 후회 분석기 3뷰 시나리오 시스템 초기화 완료
2025-08-19 05:32:52,757 - dynamic_gpu_manager - INFO - Dynamic GPU Manager initialized - Total GPU Memory: 8.0GB
2025-08-19 05:32:52,758 - RedHeart.PhaseControllerHook - INFO - PhaseController Hook GPU 메모리 관리 활성화
2025-08-19 05:32:52,758 - RedHeart.PhaseControllerHook - INFO - PhaseController Hook 시스템 초기화 완료
2025-08-19 05:32:52,758 - RedHeart.PhaseControllerHook - INFO - 성능 모니터링 시작
2025-08-19 05:32:52,759 - advanced_regret_analyzer - INFO - 후회 분석기 PhaseController Hook 초기화 완료
2025-08-19 05:32:52,759 - advanced_regret_analyzer - INFO - Advanced Regret Analyzer initialized on cuda
2025-08-19 05:32:52,759 - advanced_regret_analyzer - INFO - 동적 임계값 시스템 통합 완료
2025-08-19 05:32:52,759 - advanced_analyzer_wrappers - INFO -   - regret_network 등록 (3M)
2025-08-19 05:32:52,759 - advanced_analyzer_wrappers - INFO -   - counterfactual_sim 등록 (15M)
2025-08-19 05:32:52,760 - advanced_analyzer_wrappers - INFO -   - temporal_propagation 등록 (12M)
2025-08-19 05:32:52,760 - advanced_analyzer_wrappers - INFO -   - decision_tree 등록 (10M)
2025-08-19 05:32:52,760 - advanced_analyzer_wrappers - INFO -   - bayesian_inference 등록 (10M)
2025-08-19 05:32:52,760 - advanced_analyzer_wrappers - INFO - ✅ Advanced Regret Analyzer Wrapper 초기화 (50M 파라미터)
2025-08-19 05:32:53,044 - RedHeart.Config - INFO - GPU 직접 사용: None (사용률: 2.2%, 필요: 500MB)
2025-08-19 05:32:53,126 - RedHeart.AdvancedSURDAnalyzer - INFO - ✅ SURD 분석기 강화 모듈 통합: 12.2M 파라미터 추가
2025-08-19 05:32:53,157 - RedHeart.AdvancedSURDAnalyzer - INFO - 새로운 고급 SURD 모델 초기화 완료
2025-08-19 05:32:53,158 - RedHeart.AdvancedLLM - INFO - 모델 설정 준비 완료: ['helpingai']
2025-08-19 05:32:53,158 - RedHeart.AdvancedLLM - INFO - 동적 GPU-RAM 스왑 시스템 초기화 완료
2025-08-19 05:32:53,159 - RedHeart.AdvancedSURDAnalyzer - INFO - LLM 엔진 연결 완료
2025-08-19 05:32:53,159 - RedHeart.AdvancedSURDAnalyzer - INFO - 고급 SURD 분석 시스템 초기화 완료
2025-08-19 05:32:53,159 - advanced_analyzer_wrappers - INFO -   - deep_causal 등록 (10M)
2025-08-19 05:32:53,159 - advanced_analyzer_wrappers - INFO -   - info_decomposition 등록 (8M)
2025-08-19 05:32:53,159 - advanced_analyzer_wrappers - INFO -   - neural_causal_model 등록 (5M)
2025-08-19 05:32:53,160 - advanced_analyzer_wrappers - INFO - ✅ Advanced SURD Analyzer Wrapper 초기화 (25M 파라미터)
2025-08-19 05:32:53,803 - RedHeart.AdvancedBenthamCalculator - INFO - ✅ 벤담 계산기 강화 모듈 통합: 72.8M 파라미터 추가
2025-08-19 05:32:53,817 - RedHeart.AdvancedBenthamCalculator - INFO - 벤담 계산기 윤리 MoE 시스템 초기화 완료 (4개 전문가)
2025-08-19 05:32:53,818 - dynamic_gpu_manager - INFO - Dynamic GPU Manager initialized - Total GPU Memory: 8.0GB
2025-08-19 05:32:53,818 - RedHeart.ThreeViewScenarioSystem - INFO - 3뷰 시나리오 시스템 GPU 메모리 관리 활성화
2025-08-19 05:32:53,819 - RedHeart.ThreeViewScenarioSystem - INFO - 3뷰 시나리오 시스템 초기화 완료 (온디맨드 로딩 방식)
2025-08-19 05:32:53,819 - RedHeart.AdvancedBenthamCalculator - INFO - 벤담 계산기 3뷰 시나리오 시스템 초기화 완료
2025-08-19 05:32:53,819 - RedHeart.AdvancedBenthamCalculator - INFO - 신경망 가중치 예측기 로딩 중...
2025-08-19 05:32:53,820 - RedHeart.Config - INFO - GPU 직접 사용: None (사용률: 6.2%, 필요: 100MB)
2025-08-19 05:32:53,823 - RedHeart.AdvancedBenthamCalculator - INFO - 신경망 가중치 예측기 로드: cuda (100MB)
2025-08-19 05:32:53,824 - RedHeart.AdvancedBenthamCalculator - INFO - 메모리 사용량: RAM 2882MB, GPU 512MB
2025-08-19 05:32:53,824 - dynamic_gpu_manager - INFO - Dynamic GPU Manager initialized - Total GPU Memory: 8.0GB
2025-08-19 05:32:53,824 - RedHeart.PhaseControllerHook - INFO - PhaseController Hook GPU 메모리 관리 활성화
2025-08-19 05:32:53,825 - RedHeart.PhaseControllerHook - INFO - PhaseController Hook 시스템 초기화 완료
2025-08-19 05:32:53,825 - RedHeart.PhaseControllerHook - INFO - 성능 모니터링 시작
2025-08-19 05:32:53,825 - RedHeart.AdvancedBenthamCalculator - INFO - 벤담 계산기 PhaseController Hook 초기화 완료
2025-08-19 05:32:53,826 - dynamic_gpu_manager - INFO - Dynamic GPU Manager initialized - Total GPU Memory: 8.0GB
2025-08-19 05:32:53,826 - RedHeart.LegalExpertSystem - INFO - 법률 전문가 시스템 GPU 메모리 관리 활성화
2025-08-19 05:32:53,826 - RedHeart.LegalExpertSystem - INFO - 법률 전문가 시스템 초기화 완료 (온디맨드 로딩 방식)
2025-08-19 05:32:53,826 - RedHeart.LegalExpertSystem - INFO - inference 모드 - 법률 전문가 시스템 활성화
2025-08-19 05:32:53,826 - RedHeart.AdvancedBenthamCalculator - INFO - 벤담 계산기 법률 전문가 시스템 초기화 완료
2025-08-19 05:32:53,827 - RedHeart.AdvancedBenthamCalculator - INFO - 고급 벤담 쾌락 계산기 초기화 완료 (레이지 로딩 활성화)
2025-08-19 05:32:53,827 - RedHeart.AdvancedBenthamCalculator - INFO - 🔨 벤담 계산기 기본 PyTorch 네트워크 생성 중...
2025-08-19 05:32:53,828 - RedHeart.AdvancedBenthamCalculator - INFO - ✅ 벤담 계산기 기본 네트워크 생성 완료 (device: cuda:0)
2025-08-19 05:32:53,828 - RedHeart.AdvancedBenthamCalculator - INFO -    - 파라미터 수: 3,137
2025-08-19 05:32:53,829 - RedHeart.AdvancedBenthamCalculator - INFO - 트랜스포머 맥락 분석기 로딩 중...
2025-08-19 05:32:53,829 - config - INFO - GPU 로딩 워커 스레드 시작
2025-08-19 05:32:53,829 - RedHeart.Config - INFO - 순차적 GPU 로딩 시스템 시작
2025-08-19 05:32:53,830 - asyncio - DEBUG - Using selector: EpollSelector
2025-08-19 05:32:53,830 - RedHeart.Config - INFO - GPU 로딩 시작: bentham_emotion_classifier (예상 메모리: 732MB)
2025-08-19 05:32:52,129 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /j-hartmann/emotion-english-distilroberta-base/resolve/main/config.json HTTP/1.1" 307 0
2025-08-19 05:32:52,137 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /api/resolve-cache/models/j-hartmann/emotion-english-distilroberta-base/0e1cd914e3d46199ed785853e12b57304e04178b/config.json HTTP/1.1" 200 0
2025-08-19 05:33:02,973 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /j-hartmann/emotion-english-distilroberta-base/resolve/main/model.safetensors HTTP/1.1" 404 0
2025-08-19 05:33:02,975 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-08-19 05:33:03,193 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/j-hartmann/emotion-english-distilroberta-base HTTP/1.1" 200 5096
2025-08-19 05:33:03,420 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/j-hartmann/emotion-english-distilroberta-base/commits/main HTTP/1.1" 200 11013
2025-08-19 05:33:03,650 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/j-hartmann/emotion-english-distilroberta-base/discussions?p=0 HTTP/1.1" 200 35391
2025-08-19 05:33:03,878 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/j-hartmann/emotion-english-distilroberta-base/commits/refs%2Fpr%2F3017 HTTP/1.1" 200 11763
2025-08-19 05:33:04,082 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "GET /api/models/j-hartmann/emotion-english-distilroberta-base/tree/main/additional_chat_templates?recursive=False&expand=False HTTP/1.1" 404 64
2025-08-19 05:33:04,087 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /j-hartmann/emotion-english-distilroberta-base/resolve/refs%2Fpr%2F3017/model.safetensors.index.json HTTP/1.1" 404 0
Device set to use cuda:0
2025-08-19 05:33:04,302 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /j-hartmann/emotion-english-distilroberta-base/resolve/refs%2Fpr%2F3017/model.safetensors HTTP/1.1" 302 0
2025-08-19 05:33:04,434 - RedHeart.Config - INFO - GPU 로딩 성공: bentham_emotion_classifier (사용률: 6.2% → 10.1%, 실제: 307MB)
2025-08-19 05:33:04,440 - advanced_analyzer_wrappers - INFO -   - cross_cultural 등록
2025-08-19 05:33:04,440 - advanced_analyzer_wrappers - INFO -   - deep_ethics 등록
2025-08-19 05:33:04,441 - advanced_analyzer_wrappers - INFO -   - default_network 등록
2025-08-19 05:33:04,441 - advanced_analyzer_wrappers - INFO -   - ethics_moe 등록
2025-08-19 05:33:04,441 - advanced_analyzer_wrappers - INFO -   - long_term_predictor 등록
2025-08-19 05:33:04,441 - advanced_analyzer_wrappers - INFO -   - neural_predictor 등록
2025-08-19 05:33:04,442 - advanced_analyzer_wrappers - INFO -   - social_impact 등록
2025-08-19 05:33:04,442 - RedHeart.AdvancedBenthamCalculator - INFO - 가중치 레이어들 로딩 중...
2025-08-19 05:33:04,443 - RedHeart.AdvancedBenthamCalculator - INFO - 메모리 사용량: RAM 2886MB, GPU 512MB
2025-08-19 05:33:04,443 - advanced_analyzer_wrappers - INFO - ✅ Advanced Bentham Calculator Wrapper 초기화 (2.5M 파라미터)
2025-08-19 05:33:04,444 - advanced_analyzer_wrappers - INFO - ✅ Advanced Analyzer Wrappers 생성 완료
2025-08-19 05:33:04,444 - advanced_analyzer_wrappers - INFO -   - 총 Wrapper 수: 3
2025-08-19 05:33:04,445 - advanced_analyzer_wrappers - INFO -   - 총 파라미터: 127,570,805
2025-08-19 05:33:04,551 - emotion_dsp_simulator - INFO - EmotionDSPSimulator 초기화 완료 (~14M 파라미터)
2025-08-19 05:33:05,166 - training.advanced_training_techniques - DEBUG -   Layer 0: LR=1.8e-28 (241 params)
2025-08-19 05:33:05,166 - training.advanced_training_techniques - DEBUG -   Layer 1: LR=2.3e-28 (170 params)
2025-08-19 05:33:05,167 - training.advanced_training_techniques - DEBUG -   Layer 2: LR=2.8e-28 (216 params)
2025-08-19 05:33:05,167 - training.advanced_training_techniques - DEBUG -   Layer 3: LR=3.5e-28 (100 params)
2025-08-19 05:33:05,167 - training.advanced_training_techniques - DEBUG -   Layer 4: LR=4.4e-28 (78 params)
2025-08-19 05:33:05,167 - training.advanced_training_techniques - DEBUG -   Layer 5: LR=5.5e-28 (66 params)
2025-08-19 05:33:05,168 - training.advanced_training_techniques - DEBUG -   Layer 6: LR=6.9e-28 (20 params)
2025-08-19 05:33:05,168 - training.advanced_training_techniques - DEBUG -   Layer 7: LR=8.6e-28 (28 params)
2025-08-19 05:33:05,168 - training.advanced_training_techniques - DEBUG -   Layer 8: LR=1.1e-27 (10 params)
2025-08-19 05:33:05,168 - training.advanced_training_techniques - DEBUG -   Layer 9: LR=1.3e-27 (8 params)
2025-08-19 05:33:05,168 - training.advanced_training_techniques - DEBUG -   Layer 10: LR=1.7e-27 (8 params)
2025-08-19 05:33:05,169 - training.advanced_training_techniques - INFO - ✅ LLRD 초기화: 246개 레이어
2025-08-19 05:33:05,169 - training.advanced_training_techniques - INFO -   - Base LR: 1.0e-04
2025-08-19 05:33:05,169 - training.advanced_training_techniques - INFO -   - Decay Rate: 0.8
2025-08-19 05:33:05,169 - training.advanced_training_techniques - INFO - ✅ Advanced Training 컴포넌트 초기화 완료
2025-08-19 05:33:05,171 - RedHeart.UnifiedTrainingFinal - INFO - ✅ 모델 초기화 완료: 171.7M 파라미터
2025-08-19 05:33:05,454 - RedHeart.UnifiedTrainingFinal - INFO - ✅ 데이터 로더 초기화: Train=9414, Val=1046
2025-08-19 05:33:05,456 - RedHeart.UnifiedTrainingFinal - INFO - ✅ 옵티마이저 및 스케줄러 초기화 완료
2025-08-19 05:33:05,456 - RedHeart.UnifiedTrainingFinal - WARNING - ⚠️ 파라미터 업데이트 비활성화 - 검증 모드
2025-08-19 05:33:05,456 - RedHeart.UnifiedTrainingFinal - INFO - 
======================================================================
2025-08-19 05:33:05,457 - RedHeart.UnifiedTrainingFinal - INFO - 🚀 학습 시작
2025-08-19 05:33:05,457 - RedHeart.UnifiedTrainingFinal - INFO - ======================================================================
2025-08-19 05:33:05,457 - RedHeart.UnifiedTrainingFinal - INFO - 
======================================================================
2025-08-19 05:33:05,457 - RedHeart.UnifiedTrainingFinal - INFO - 🔍 Learning Rate Sweep 시작...
2025-08-19 05:33:05,457 - RedHeart.UnifiedTrainingFinal - INFO - ======================================================================
2025-08-19 05:33:05,458 - training.lr_sweep_optimizer - INFO - 🔍 LR Sweep 시작...
2025-08-19 05:33:05,458 - training.lr_sweep_optimizer - INFO - 
[1/5] LR=1.0e-05 테스트
🔧 klue/bert-base 모델: 안정성 보장을 위한 15.0% 할당
📋 Transformer 모델: 최적화된 배치 처리 방식 활성화
Traceback (most recent call last):
  File "/mnt/c/large_project/linux_red_heart/training/unified_training_final.py", line 726, in <module>
    main()
  File "/mnt/c/large_project/linux_red_heart/training/unified_training_final.py", line 722, in main
    trainer.train()
  File "/mnt/c/large_project/linux_red_heart/training/unified_training_final.py", line 565, in train
    self.run_lr_sweep()
  File "/mnt/c/large_project/linux_red_heart/training/unified_training_final.py", line 407, in run_lr_sweep
    sweep_results = self.lr_sweep.run_sweep(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/large_project/linux_red_heart/training/lr_sweep_optimizer.py", line 94, in run_sweep
    sweep_result = self._run_single_sweep(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/large_project/linux_red_heart/training/lr_sweep_optimizer.py", line 143, in _run_single_sweep
    for step, batch in enumerate(train_loader):
  File "/mnt/c/large_project/linux_red_heart/red_heart_env/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/mnt/c/large_project/linux_red_heart/red_heart_env/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1465, in _next_data
    return self._process_data(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/large_project/linux_red_heart/red_heart_env/lib/python3.12/site-packages/torch/utils/data/dataloader.py", line 1491, in _process_data
    data.reraise()
  File "/mnt/c/large_project/linux_red_heart/red_heart_env/lib/python3.12/site-packages/torch/_utils.py", line 715, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/mnt/c/large_project/linux_red_heart/red_heart_env/lib/python3.12/site-packages/torch/utils/data/_utils/worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/large_project/linux_red_heart/red_heart_env/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 50, in fetch
    data = self.dataset.__getitems__(possibly_batched_index)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/large_project/linux_red_heart/red_heart_env/lib/python3.12/site-packages/torch/utils/data/dataset.py", line 420, in __getitems__
    return [self.dataset[self.indices[idx]] for idx in indices]
            ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/large_project/linux_red_heart/training/unified_training_final.py", line 333, in __getitem__
    'emotion_label': torch.tensor(item.get('label', 0), dtype=torch.long),
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: new(): invalid data type 'str'

[0;34m[INFO][0m 학습 시스템 정리 중...
[0;34m[INFO][0m GPU 메모리 정리...
[0;32m[SUCCESS][0m 정리 완료
