● Red Heart AI 학습 시스템 심층 분석 보고서

  1. 현재 상황

  - Claude API 전처리: 510개 샘플 처리 완료 ($2.51 소비)
  - 학습 시스템 분석: unified_training_v2.py 중심으로 진행

  2. 확인된 문제점

  2.1 더미 데이터 문제 ✅ 확인됨

  # 문제 1: emotion analyzer에서 더미 타깃 (582번 라인)
  target = torch.randint(0, 7, (batch_size,)).to(self.device)

  # 문제 2: _eval_step에서 더미 입력 (713번 라인)
  dummy_input = torch.randn(batch_size, 768, requires_grad=False).to(self.device)

  2.2 손실함수 불일치 ✅ 확인됨

  - 헤드가 compute_loss 메소드 제공하나 사용 안함
  - 직접 F.mse_loss, F.cross_entropy 사용 중
  - EmotionHead는 CE/Focal Loss 기반이나 MSE로 학습

  2.3 수정된 부분 ✅

  - context_embedding 사용: text_embedding 대신 정상 사용
  - 전처리 파이프라인: v3 정상 import
  - 옵티마이저 파라미터: 백본, 헤드, analyzer 모두 포함

  3. 모듈별 학습 상태 분석

  3.1 감정 분석기 (미확인)

  - 3-phase hierarchical 학습: 파일 없음, 구현 확인 필요
  - 필요 파라미터: phase1_encoder, phase2_attention, phase3_classifier
  - 학습 여부: 미확인

  3.2 DSP 모듈 (미확인)

  - 칼만 필터: 학습 가능 파라미터 존재 여부 불명
  - 신호 처리: 고정 수식 vs 학습 가능 파라미터 확인 필요

  3.3 SURD (미확인)

  - 원래: Selection, Uncertainty, Risk, Decision 수식 기반
  - 학습 변환: 수식→신경망 파라미터 전환 필요
  - 현재 상태: 구현 파일 미발견

  3.4 후회 모듈 (미확인)

  - 반사실 추론: 별도 구현 필요
  - 학습 파라미터: regret_encoder, counterfactual_generator
  - 현재 상태: 구현 확인 필요

  3.5 Neural Analyzers (부분 확인)

  - create_neural_analyzers()로 232M 파라미터 로드
  - 옵티마이저에 포함됨
  - 하지만 실제 구현체 파일 미발견

  3.6 Advanced Analyzers (부분 확인)

  - 조건부 로드 (--use-advanced 플래그)
  - isinstance(nn.Module) 체크로 학습 포함

  4. 파라미터 학습 완전성

  ✅ 학습 포함 확인

  - 백본 파라미터
  - 헤드 파라미터
  - analyzer 파라미터 (neural_, advanced_ 모두)

  ❌ 미확인/문제

  - 3-phase hierarchical emotion 구현체
  - DSP/칼만 필터 학습 가능 파라미터
  - SURD 신경망 전환 구현
  - 후회 반사실 추론 파라미터

  5. 긴급 수정 필요 사항

  1. torch.randint/randn 제거
  2. head.compute_loss() 사용
  3. 누락 모듈 구현체 확인
  4. SURD 수식→학습 전환
  5. 반사실 추론 모듈 통합

  6. 다음 단계

  1. 누락 모듈 파일 검색
  2. 실제 구현 vs 스켈레톤 구분
  3. 학습 가능 파라미터 전체 목록화
  4. 수정 패치 작성
